<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title> Project Nightfall </title>
<style>
  :root { 
    --bg:#0a0c10; --card:#11151c; --muted:#8992a1; --text:#e1e8f5; --accent:#58a6ff; 
    --good:#3fb950; --bad:#f85149; --warn:#d29922; --border: #21262d; --header-bg: #0d1117;
    --sev-high: #da3633; --sev-med: #c6831b; --sev-low: #255c91;
    --tactic-bg: rgba(88, 166, 255, 0.1); --tactic-border: rgba(88, 166, 255, 0.3);
  }
  * { box-sizing: border-box; }
  body { margin:0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji"; color:var(--text); background-color: var(--bg); font-size: 14px; }
  header { padding:16px 24px; border-bottom:1px solid var(--border); background-color:var(--header-bg); }
  h1 { margin:0; font-size:22px; }
  header p { margin:4px 0 0; color:var(--muted); font-size:15px; }
  main { max-width:1280px; margin: 24px auto 80px; padding: 0 24px; }
  .grid { display:grid; grid-template-columns: 1fr; gap:24px; }
  @media (min-width: 1024px) { .grid { grid-template-columns: 1.5fr 1fr; } }
  .card { background:var(--card); border:1px solid var(--border); border-radius:8px; overflow: hidden; }
  .card h2 { margin:0; font-size:16px; font-weight: 600; padding:12px 16px; border-bottom:1px solid var(--border); background:var(--header-bg); }
  .card .body { padding:16px; }
  
  /* SIEM Interface Styles */
  .siem-pane .tabs { display: flex; border-bottom: 1px solid var(--border); background-color: var(--header-bg); }
  .siem-pane .tab { padding: 10px 16px; cursor: pointer; border: none; background: none; color: var(--muted); font-weight: 500; border-bottom: 2px solid transparent; }
  .siem-pane .tab.active { color: var(--text); border-bottom: 2px solid var(--accent); }
  .tab-content { display: none; }
  .tab-content.active { display: block; }
  
  /* Alert Details View */
  .details-grid { display: grid; grid-template-columns: 150px 1fr; gap: 12px; }
  .details-grid dt { color: var(--muted); font-weight: 600; }
  .details-grid dd { margin: 0; }
  .severity { padding: 3px 8px; border-radius: 16px; font-weight: 600; font-size: 12px; display: inline-block; }
  .sev-high { background-color: rgba(218, 54, 51, 0.15); color: var(--sev-high); }
  .sev-med { background-color: rgba(198, 131, 27, 0.15); color: var(--sev-med); }
  .tactic { font-family: monospace; font-size: 12px; color: var(--accent); background-color: var(--tactic-bg); border: 1px solid var(--tactic-border); padding: 3px 6px; border-radius: 4px; }

  /* Timeline View */
  .timeline-event { position: relative; padding: 8px 0 8px 32px; border-left: 2px solid #2a303a; }
  .timeline-event:before { content: ''; position: absolute; left: -7px; top: 16px; width: 12px; height: 12px; border-radius: 50%; background-color: var(--muted); border: 2px solid var(--bg); }
  .timeline-event.risk-high:before { background-color: var(--sev-high); }
  .timeline-event.risk-med:before { background-color: var(--sev-med); }
  .event-time { font-family: monospace; font-size: 12px; color: var(--muted); }
  .event-desc { font-weight: 500; }
  .event-desc .icon { vertical-align: middle; margin-right: 4px; }
  .process-tree { padding-left: 20px; }
  code, .mono { font-family: "SF Mono", "Consolas", "Liberation Mono", Menlo, monospace; color: #c9d1d9; font-size: 13px; }
  .cmd { background: #010409; border: 1px solid var(--border); padding: 8px; border-radius: 6px; margin-top: 6px; overflow-x: auto; }
  
  /* Entity View */
  .entity-card { background: #0d1117; border: 1px solid var(--border); border-radius: 6px; padding: 12px; margin-bottom: 12px; display: flex; align-items: center; gap: 12px; }
  .entity-card .icon { flex-shrink: 0; }
  .entity-info h3 { margin: 0 0 4px; font-size: 15px; }
  .entity-info p { margin: 0; color: var(--muted); }
  
  /* Quiz Section Styles */
  .q { border:1px solid var(--border); background: var(--header-bg); border-radius:8px; padding:16px; margin:16px 0; }
  .q h3 { margin:0 0 12px; font-size:15px; line-height: 1.4; }
  .opts { display:grid; gap:8px; }
  .opt { display:flex; align-items:flex-start; gap:10px; padding:10px 12px; border:1px solid var(--border); border-radius:6px; cursor:pointer; transition: background-color 0.2s; }
  .opt:hover { background-color: #161b22; }
  .opt input { margin-top:3px; }
  .toolbar { display:flex; gap:10px; justify-content:flex-end; margin-top:16px; padding: 16px; border-top:1px solid var(--border); }
  button { border:1px solid var(--border); background:#21262d; color:var(--text); padding:8px 16px; border-radius:6px; cursor:pointer; font-weight:600; transition: all 0.2s; }
  button:hover { background: #30363d; border-color: #8b949e; }
  .primary { background: #238636; border-color: #2ea043; }
  .primary:hover { background: #2ea043; border-color: #3fb950; }
  .result { margin-top:16px; padding:16px; border-radius:8px; border:1px solid var(--border); background:var(--header-bg); }
  .result h3 { margin:0 0 8px; font-size: 16px; }
  .explain { margin-top:12px; padding:12px; border-left: 3px solid var(--border); color:var(--muted); background:#010409; }
  .explain.correct { border-left-color: var(--good); }
  .explain.incorrect { border-left-color: var(--bad); }
  .scorebar { height:8px; background:var(--border); border-radius:999px; overflow:hidden; margin-top:8px; }
  .scorefill { height:100%; width:0%; background:linear-gradient(90deg, #f85149, #d29922 50%, #3fb950 100%); transition:width .5s ease; }
  .hidden { display:none; }
  .icon { display: inline-block; vertical-align: text-bottom; }
</style>
</head>
<body>
<!-- Icons SVG Defs -->
<svg width="0" height="0" class="hidden">
  <defs>
    <symbol id="icon-device" viewBox="0 0 16 16"><path fill="currentColor" d="M12.5 0H3.5A1.5 1.5 0 0 0 2 1.5v13A1.5 1.5 0 0 0 3.5 16h9a1.5 1.5 0 0 0 1.5-1.5v-13A1.5 1.5 0 0 0 12.5 0Zm-10 13.5v-11h11v11Z"></path></symbol>
    <symbol id="icon-user" viewBox="0 0 16 16"><path fill="currentColor" d="M8 8a3 3 0 1 0 0-6a3 3 0 0 0 0 6Zm2-3a2 2 0 1 1-4 0a2 2 0 0 1 4 0Zm4 8c0 1-1 1-1 1H3s-1 0-1-1s1-4 6-4s6 3 6 4Zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10Z"></path></symbol>
    <symbol id="icon-tactic" viewBox="0 0 16 16"><path fill="currentColor" d="m8.43.512l5.053 5.053a1.25 1.25 0 0 1 0 1.768l-5.053 5.053a1.25 1.25 0 0 1-1.768 0L1.61 7.333a1.25 1.25 0 0 1 0-1.768L6.662.512a1.25 1.25 0 0 1 1.768 0ZM3.02 6.5l3.53 3.53l3.53-3.53L6.55 2.97Z"></path></symbol>
    <symbol id="icon-file" viewBox="0 0 16 16"><path fill="currentColor" d="M3.75 1.5A1.75 1.75 0 0 0 2 3.25v9.5A1.75 1.75 0 0 0 3.75 14.5h8.5A1.75 1.75 0 0 0 14 12.75v-7.5L9.75 1.5Z M9 2.25L12.75 6H9Z"></path></symbol>
    <symbol id="icon-ip" viewBox="0 0 16 16"><path fill="currentColor" d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16ZM4 8a1 1 0 0 1 1-1h1a1 1 0 0 1 0 2H5a1 1 0 0 1-1-1Zm3 0a1 1 0 0 1 1-1h2a1 1 0 1 1 0 2H8a1 1 0 0 1-1-1Z"></path></symbol>
    <symbol id="icon-dc" viewBox="0 0 16 16"><path fill="currentColor" d="M2.5 2A1.5 1.5 0 0 0 1 3.5v9A1.5 1.5 0 0 0 2.5 14h11a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 13.5 2ZM3 4h10v1H3Zm0 3h10v1H3Zm0 3h10v1H3Z"></path></symbol>
  </defs>
</svg>

<header>
  <h1>Cyber Security  Analyst Simulation â€” Project Nightfall</h1>
  <p>An active intrusion has been detected. Analyze the artifacts to determine scope, impact, and the critical next steps.</p>
</header>

<main>
  <div class="grid">

    <section class="card siem-pane">
      <nav class="tabs">
        <button class="tab active" data-tab="alert">Alert Details</button>
        <button class="tab" data-tab="timeline">Host Timeline</button>
        <button class="tab" data-tab="entities">Entity Info</button>
      </nav>
      
      <div id="alert" class="tab-content active body">
        <h2>Alert: New Domain Admin Created via Remote Session</h2>
        <dl class="details-grid">
          <dt>Severity</dt><dd><span class="severity sev-high">High</span></dd>
          <dt>Time</dt><dd>2025-10-26 11:35:12 UTC</dd>
          <dt>Source Host</dt><dd><code class="mono">WEB-SRV-01</code></dd>
          <dt>Target Host</dt><dd><code class="mono">DC-01</code></dd>
          <dt>User Account</dt><dd><code class="mono">svc_backup</code> (newly created)</dd>
          <dt>Tactic</dt><dd><span class="tactic">TA0003 - Persistence</span></dd>
          <dt>Technique</dt><dd><span class="tactic">T1098 - Account Manipulation</span></dd>
        </dl>
        <p style="margin-top: 16px;">A new user account, `svc_backup`, was created on the domain controller `DC-01` and immediately added to the 'Domain Admins' group. The activity originated from a remote session initiated by `WEB-SRV-01`. This is a critical indicator of a compromised environment.</p>
      </div>

      <div id="timeline" class="tab-content body">
        <h2>Combined Host Timeline</h2>
        <h4>WEB-SRV-01 (Public Web Server)</h4>
        <div class="timeline-event risk-med">
          <div class="event-time">11:18:45 UTC</div>
          <div class="event-desc">
            <svg class="icon" width="16" height="16"><use href="#icon-device"></use></svg>
            Process <code class="mono">confluence.exe</code> (PID 1884) spawned a child process.
          </div>
          <div class="process-tree">
             <div class="event-desc">
              <svg class="icon" width="16" height="16"><use href="#icon-device"></use></svg>
              Child: <code class="mono">wsmprovhost.exe</code> (PID 7236)
            </div>
            <div class="cmd">Command: wsmprovhost.exe -Embedding</div>
          </div>
        </div>
        <div class="timeline-event risk-high">
          <div class="event-time">11:22:10 UTC</div>
          <div class="event-desc">
            <svg class="icon" width="16" height="16"><use href="#icon-device"></use></svg>
            <code class="mono">wsmprovhost.exe</code> (PID 7236) performed a credential dumping action.
            <div class="cmd">Technique: Accessing LSASS via comsvcs.dll memory dump.</div>
          </div>
        </div>
        <div class="timeline-event risk-med">
          <div class="event-time">11:25:03 UTC</div>
          <div class="event-desc">
            <svg class="icon" width="16" height="16"><use href="#icon-file"></use></svg>
            <code class="mono">lsass.dmp</code> created in <code class="mono">C:\Windows\Temp\</code>
          </div>
        </div>
        <div class="timeline-event risk-high">
          <div class="event-time">11:28:19 UTC</div>
          <div class="event-desc">
            <svg class="icon" width="16" height="16"><use href="#icon-device"></use></svg>
            <code class="mono">wsmprovhost.exe</code> (PID 7236) cleared system logs.
            <div class="cmd">Command: wevtutil.exe cl Security</div>
          </div>
        </div>
        <h4 style="margin-top: 24px;">DC-01 (Domain Controller)</h4>
        <div class="timeline-event risk-high">
          <div class="event-time">11:34:50 UTC</div>
          <div class="event-desc">
             <svg class="icon" width="16" height="16"><use href="#icon-user"></use></svg>
            Successful remote logon from <code class="mono">WEB-SRV-01</code> (172.16.10.5) as user <code class="mono">NETWORK SERVICE</code>.
          </div>
        </div>
        <div class="timeline-event risk-high">
          <div class="event-time">11:35:12 UTC</div>
          <div class="event-desc">
            <svg class="icon" width="16" height="16"><use href="#icon-device"></use></svg>
            Process <code class="mono">net1.exe</code> (PID 9104) created a new user.
            <div class="cmd">Command: net user svc_backup TempPass123! /add</div>
          </div>
        </div>
        <div class="timeline-event risk-high">
          <div class="event-time">11:35:45 UTC</div>
          <div class="event-desc">
             <svg class="icon" width="16" height="16"><use href="#icon-user"></use></svg>
            User <code class="mono">svc_backup</code> added to 'Domain Admins' group.
            <div class="cmd">Command: net group "Domain Admins" svc_backup /add</div>
          </div>
        </div>
      </div>

      <div id="entities" class="tab-content body">
        <h2>Key Entities Involved</h2>
        <div class="entity-card">
          <svg class="icon" width="32" height="32" style="color:#d29922;"><use href="#icon-device"></use></svg>
          <div class="entity-info">
            <h3>WEB-SRV-01</h3>
            <p><span class="mono">172.16.10.5</span> â€” Public-facing Confluence Server (Linux)</p>
          </div>
        </div>
        <div class="entity-card">
          <svg class="icon" width="32" height="32" style="color:#58a6ff;"><use href="#icon-dc"></use></svg>
          <div class="entity-info">
            <h3>DC-01</h3>
            <p><span class="mono">10.0.0.5</span> â€” Primary Domain Controller</p>
          </div>
        </div>
        <div class="entity-card">
          <svg class="icon" width="32" height="32" style="color:#f85149;"><use href="#icon-user"></use></svg>
          <div class="entity-info">
            <h3>svc_backup</h3>
            <p>Newly created account with Domain Admin privileges. Likely threat actor controlled.</p>
          </div>
        </div>
        <div class="entity-card">
          <svg class="icon" width="32" height="32" style="color:#8992a1;"><use href="#icon-file"></use></svg>
          <div class="entity-info">
            <h3>wsmprovhost.exe</h3>
            <p>LOLBAS (Living Off the Land Binary). Legitimate Windows process used here for malicious activity.</p>
          </div>
        </div>
      </div>
    </section>

    <section class="card" id="quiz">
      <h2>Response & Analysis Questions</h2>
      <div class="body" id="questions"></div>
      <div class="toolbar">
        <button class="primary" id="submitBtn">Submit Assessment</button>
      </div>
      <div class="result hidden" id="result">
        <h3 id="scoreLine"></h3>
        <div class="scorebar"><div class="scorefill" id="scoreFill"></div></div>
        <p id="passFail"></p>
        <div id="explanations"></div>
      </div>
    </section>

  </div>
</main>

<script>
const PASS_THRESHOLD = 80;
const QUESTIONS = [
  {
    id: 1,
    text: "Based on the timeline, what is the most likely initial access point for this attack?",
    options: [
      "A phishing email sent to an administrator",
      "An exposed RDP port on the Domain Controller",
      "A software vulnerability in the Confluence service on WEB-SRV-01",
      "A brute-force attack against the NETWORK SERVICE account"
    ],
    correct: 2,
    explain: "The attack chain starts with confluence.exe spawning a suspicious process. This strongly implies an attacker exploited a vulnerability in the Confluence application to gain initial code execution."
  },
  {
    id: 2,
    text: "What is the significance of the attacker using wsmprovhost.exe?",
    options: [
      "It is the only binary capable of performing memory dumps.",
      "It is a known malware file that should be blocked by antivirus.",
      "It is a legitimate, signed Windows process, used as a LOLBAS to evade simple detection.",
      "It indicates the attacker is an unsophisticated script kiddie."
    ],
    correct: 2,
    explain: "Using legitimate system binaries (LOLBAS) like wsmprovhost.exe helps attackers blend in with normal activity and avoid detection by security products that focus only on known malicious files."
  },
  {
    id: 3,
    text: "What was the attacker's immediate objective after gaining access to WEB-SRV-01?",
    options: [
      "To deploy ransomware on the web server",
      "To steal credentials for lateral movement",
      "To deface the company website",
      "To establish a persistent C2 channel"
    ],
    correct: 1,
    explain: "The attacker's first major action was to dump the LSASS process memory, a clear technique for harvesting credentials needed to move from the initial entry point to more valuable targets."
  },
  {
    id: 4,
    text: "The command `wevtutil.exe cl Security` is a form of which ATT&CK Tactic?",
    options: [
      "Discovery",
      "Impact",
      "Defense Evasion",
      "Collection"
    ],
    correct: 2,
    explain: "Clearing security event logs is a classic Defense Evasion technique (T1070) used to remove evidence of the attacker's activities and hinder forensic investigation."
  },
  {
    id: 5,
    text: "What is the single MOST critical, immediate action to take?",
    options: [
      "Isolate WEB-SRV-01 from the network.",
      "Reboot the Domain Controller to terminate active sessions.",
      "Disable the newly created 'svc_backup' account.",
      "Run a full vulnerability scan on WEB-SRV-01."
    ],
    correct: 2,
    explain: "The attacker has created a 'golden ticket' with a new Domain Admin account. Disabling this account immediately is the top priority to revoke their highest level of access and prevent further damage."
  },
  {
    id: 6,
    text: "What does the logon to DC-01 as 'NETWORK SERVICE' likely indicate?",
    options: [
      "The attacker has compromised the NETWORK SERVICE password.",
      "The attacker exploited a privilege escalation flaw on WEB-SRV-01 to impersonate a system-level account for remote actions.",
      "This is normal, expected behavior between a web server and a domain controller.",
      "The attacker is using a password spraying attack."
    ],
    correct: 1,
    explain: "System accounts like NETWORK SERVICE cannot be logged into directly. This indicates the use of an exploit or tool (like Rotten Potato) that abuses system privileges to authenticate to other machines as the computer account itself."
  },
  {
    id: 7,
    text: "After initial containment, what is the most logical next step for the investigation?",
    options: [
      "Assume the breach is contained and re-image the two affected servers.",
      "Check all other public-facing servers for the same Confluence vulnerability.",
      "Block the IP address of WEB-SRV-01 on the firewall.",
      "Send a company-wide password reset notification."
    ],
    correct: 1,
    explain: "A skilled attacker will not stop at one server. The root cause is likely a widespread vulnerability. The next step is to find and patch all other instances to prevent re-entry or wider compromise."
  },
  {
    id: 8,
    text: "The overall goal demonstrated by this attack chain is:",
    options: [
      "Data destruction",
      "A quick ransomware deployment",
      "Establishing persistent, high-level control over the domain",
      "Cryptocurrency mining"
    ],
    correct: 2,
    explain: "Moving from a web server to a DC to create a new Domain Admin is not a smash-and-grab attack. It is a deliberate, methodical approach to gain complete and persistent control of the entire network environment."
  }
];

document.addEventListener('DOMContentLoaded', () => {
    const tabs = document.querySelectorAll('.tab');
    const tabContents = document.querySelectorAll('.tab-content');

    tabs.forEach(tab => {
        tab.addEventListener('click', () => {
            const target = tab.dataset.tab;
            
            tabs.forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
            
            tabContents.forEach(content => {
                if (content.id === target) {
                    content.classList.add('active');
                } else {
                    content.classList.remove('active');
                }
            });
        });
    });

    function renderQuestions() {
        const container = document.getElementById('questions');
        container.innerHTML = "";
        QUESTIONS.forEach((q, idx) => {
            const div = document.createElement('div');
            div.className = 'q';
            const title = document.createElement('h3');
            title.textContent = `${idx + 1}. ${q.text}`;
            div.appendChild(title);

            const opts = document.createElement('div');
            opts.className = 'opts';
            q.options.forEach((opt, i) => {
                const label = document.createElement('label');
                label.className = 'opt';
                const input = document.createElement('input');
                input.type = 'radio';
                input.name = `q${q.id}`;
                input.value = i;
                label.appendChild(input);
                const span = document.createElement('span');
                span.textContent = opt;
                label.appendChild(span);
                opts.appendChild(label);
            });
            div.appendChild(opts);
            container.appendChild(div);
        });
    }

    function grade() {
        let correct = 0;
        const explanations = [];
        QUESTIONS.forEach(q => {
            const chosen = document.querySelector(`input[name="q${q.id}"]:checked`);
            const val = chosen ? parseInt(chosen.value, 10) : -1;
            const isCorrect = val === q.correct;

            if (isCorrect) correct++;
            
            explanations.push({
                id: q.id,
                ok: isCorrect,
                text: q.explain
            });
        });

        const score = Math.round((correct / QUESTIONS.length) * 100);
        const pass = score >= PASS_THRESHOLD;

        document.getElementById('scoreLine').textContent = `Assessment Score: ${score}% (${correct}/${QUESTIONS.length})`;
        document.getElementById('passFail').innerHTML = pass
            ? `<span style="color:var(--good);">PASS</span> â€” The analysis demonstrates a strong understanding of advanced attack chains and prioritization.`
            : `<span style="color:var(--bad);">NEEDS REVIEW</span> â€” Key indicators were misinterpreted. Focus on understanding lateral movement and containment priorities.`;
        
        const fill = document.getElementById('scoreFill');
        if (score < 40) { fill.style.background = 'var(--bad)'; } 
        else if (score < PASS_THRESHOLD) { fill.style.background = 'var(--warn)'; } 
        else { fill.style.background = 'var(--good)'; }
        
        setTimeout(() => { fill.style.width = `${score}%`; }, 100);

        const explContainer = document.getElementById('explanations');
        explContainer.innerHTML = "";
        explanations.forEach(e => {
            const d = document.createElement('div');
            d.className = `explain ${e.ok ? 'correct' : 'incorrect'}`;
            const status = e.ok ? 'Correct' : 'Incorrect';
            d.innerHTML = `<strong>Q${e.id} (${status}):</strong> ${e.text}`;
            explContainer.appendChild(d);
        });

        document.getElementById('result').classList.remove('hidden');
        document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
        document.getElementById('submitBtn').disabled = true;
    }

    document.getElementById('submitBtn').addEventListener('click', grade);
    renderQuestions();
});
</script>
</body>
</html>
